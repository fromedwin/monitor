{% extends "application.html" %}
{% load fromedwin_tags %}
{% block content %}
    <div class="px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="sm:flex sm:items-center justify-between">
            <div>
                <h2 class="text-lg font-semibold">Report #{{ report.id }}</h2>
                <p class="text-sm text-gray-500">{{ project.title }} - {{ report.creation_date|date:"Y-m-d H:i:s" }}</p>
            </div>
            <div class="mt-4 sm:ml-16 sm:mt-0 sm:flex-none">
                <a href="{% url 'project_reports' project.id %}"
                   class="inline-flex items-center bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500">
                    <svg class="-ml-1 mr-2 h-5 w-5"
                         xmlns="http://www.w3.org/2000/svg"
                         fill="none"
                         viewBox="0 0 24 24"
                         stroke-width="1.5"
                         stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                    </svg>
                    Back to Project Reports
                </a>
            </div>
        </div>
        <!-- Coming Soon Content -->
        {% with report.data as data and report.data.previous_report as previous_report %}
            <div class="mt-8 flow-root">
                <div class="-mx-4 -my-2 overflow-x-auto sm:-mx-6 lg:-mx-8">
                    <div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
                        <table class="relative min-w-full divide-y divide-gray-300">
                            <thead>
                                <tr>
                                    <th scope="col"
                                        class="py-3.5 pr-3 pl-4 text-left text-sm font-semibold text-gray-900 sm:pl-3">
                                        Metric
                                    </th>
                                    <th scope="col"
                                        class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
                                        Current ({{ report.creation_date|date:"Y-m-d" }})
                                    </th>
                                    <th scope="col"
                                        class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">
                                        Previous ({{ previous_report.date|slice:":10" }})
                                    </th>
                                    <th scope="col"
                                        class="px-3 py-3.5 text-left text-sm font-semibold text-gray-900">Change</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white">
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Availability (7 days)</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.availability.7|floatformat:0 }}%</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ previous_report.availability.7|floatformat:0 }}%</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.availability.7 > previous_report.availability.7 %}
                                            ðŸ“ˆ
                                        {% elif data.availability.7 < previous_report.availability.7 %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Availability (30 days)</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.availability.30|floatformat:0 }}%</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ previous_report.availability.30|floatformat:0 }}%</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.availability.30 > previous_report.availability.30 %}
                                            ðŸ“ˆ
                                        {% elif data.availability.30 < previous_report.availability.30 %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Pages</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.pages|length }}</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ previous_report.pages|length }}</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.pages|length > previous_report.pages|length %}
                                            ðŸ“ˆ
                                        {% elif data.pages|length < previous_report.pages|length %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Pages 200</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.pages|http_status_20x_only|length }}</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.pages|http_status_20x_only|length }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.pages|http_status_20x_only|length > previous_report.pages|http_status_20x_only|length %}
                                            ðŸ“ˆ
                                        {% elif data.pages|http_status_20x_only|length < previous_report.pages|http_status_20x_only|length %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Pages 300</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.pages|http_status_300x_only|length }}</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.pages|http_status_300x_only|length }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.pages|http_status_300x_only|length > previous_report.pages|http_status_300x_only|length %}
                                            ðŸ“ˆ
                                        {% elif data.pages|http_status_300x_only|length < previous_report.pages|http_status_300x_only|length %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Pages 400</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">{{ data.pages|http_status_400x_only|length }}</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.pages|http_status_400x_only|length }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.pages|http_status_400x_only|length > previous_report.pages|http_status_400x_only|length %}
                                            ðŸ“ˆ
                                        {% elif data.pages|http_status_400x_only|length < previous_report.pages|http_status_400x_only|length %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Performance Score</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ data.performance_score.score_performance|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.performance_score.score_performance|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.performance_score.score_performance > previous_report.performance_score.score_performance %}
                                            ðŸ“ˆ
                                        {% elif data.performance_score.score_performance < previous_report.performance_score.score_performance %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Accessibility Score</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ data.performance_score.score_accessibility|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.performance_score.score_accessibility|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.performance_score.score_accessibility > previous_report.performance_score.score_accessibility %}
                                            ðŸ“ˆ
                                        {% elif data.performance_score.score_accessibility < previous_report.performance_score.score_accessibility %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">Best Practices Score</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ data.performance_score.score_best_practices|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.performance_score.score_best_practices|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.performance_score.score_best_practices > previous_report.performance_score.score_best_practices %}
                                            ðŸ“ˆ
                                        {% elif data.performance_score.score_best_practices < previous_report.performance_score.score_best_practices %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">SEO Score</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ data.performance_score.score_seo|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.performance_score.score_seo|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.performance_score.score_seo > previous_report.performance_score.score_seo %}
                                            ðŸ“ˆ
                                        {% elif data.performance_score.score_seo < previous_report.performance_score.score_seo %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                                <tr class="even:bg-gray-50">
                                    <td class="py-4 pr-3 pl-4 text-sm font-medium whitespace-nowrap text-gray-900 sm:pl-3">PWA Score</td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ data.performance_score.score_pwa|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {{ previous_report.performance_score.score_pwa|mul:100|floatformat:0 }}
                                    </td>
                                    <td class="px-3 py-4 text-sm whitespace-nowrap text-gray-500">
                                        {% if data.performance_score.score_pwa > previous_report.performance_score.score_pwa %}
                                            ðŸ“ˆ
                                        {% elif data.performance_score.score_pwa < previous_report.performance_score.score_pwa %}
                                            ðŸ“‰
                                        {% else %}
                                            âœ…
                                        {% endif %}
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        {% endwith %}
    </div>
{% endblock content %}
